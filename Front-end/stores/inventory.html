<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IEMM - ุงููุฎุฒูู</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="../views/css/styles.css">
  <link rel="stylesheet" href="../views/css/chat.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="../views/js/script.js" defer></script>
  <script src="../views/js/theme-manager.js" defer></script>
  <script src="../views/js/stores/chat.js" defer></script>
</head>
<body>
  <!-- Header Section -->
  <header>
    <div class="container navbar">
      <h1>IEMM</h1>
      <nav>
        <a href="shop-dashboard.html" id="dashboard-link" >๐ ููุญุฉ ุงูุชุญูู</a>
        <a href="products-management.html" id="products-link">๐๏ธ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</a>
        <a href="inventory.html" id="inventory-link" class="active">๐ฆ ุงููุฎุฒูู</a>

        <a href="employees.html" id="staff-link">๐ฅ ุฅุฏุงุฑุฉ ุงูุนุงูููู</a>
        <a href="bills-stores.html" id="bills-link">๐ฐ ุงูููุงุชูุฑ</a>
      </nav>
      <div style="display: flex; align-items: center; gap: 12px;">
 <button class="btn-dark convert" ></button>
        <!-- <button class="btn-dark " onclick="document.body.classList.toggle('dark')">ุงููุถุน ุงููููู</button> -->        <button id="chat-toggle" class="chat-toggle-btn" title="ุงูุฏุฑุฏุดุฉ ูุน ูุฏูุฑ ุงูููู">
          <i class="fas fa-comments"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- ูุงูุฐุฉ ุงูุฏุฑุฏุดุฉ ุงูุฌุงูุจูุฉ -->
  <div id="chat-panel" class="chat-panel">
    <div class="chat-header">
      <div class="mall-logo-container">
        <img id="mall-logo" alt="ุดุนุงุฑ ุงูููู" class="mall-logo">
        <h3>ุงูุฏุฑุฏุดุฉ ูุน ูุฏูุฑ ุงูููู</h3>
      </div>
      <button id="chat-close" class="chat-close-btn">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div id="messages-container" class="messages-container">
      <!-- ุณูุชู ุฅูุดุงุก ุงูุฑุณุงุฆู ุนุจุฑ JavaScript -->
    </div>
    <form id="message-form" class="message-form">
      <textarea id="message-input" class="message-input" placeholder="ุงูุชุจ ุฑุณุงูุชู ููุง..." rows="1"></textarea>
      <button type="submit" class="send-message-btn">
        <i class="fas fa-paper-plane"></i>
      </button>
    </form>
  </div>

    <!-- Main Content -->
    <div class="main">
      <!-- Inventory Management Section -->
      <div class="section active" id="inventory-section">
        <div class="section-header">
          <h2 class="section-title">๐ฆ ุฅุฏุงุฑุฉ ุงููุฎุฒูู</h2>
        </div>
        <div class="alerts card">
          <h3>๐จ ุชูุจููุงุช ุงููุฎุฒูู</h3>
          <div id="inventory-alerts">
            <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
          </div>
        </div>

        <div class="table card">
          <div class="table-header">
            <h3>ูุงุฆูุฉ ุงููุฎุฒูู</h3>
            <button class="btn-green" onclick="document.getElementById('newInventoryFormContainer').style.display = document.getElementById('newInventoryFormContainer').style.display === 'none' ? 'block' : 'none'">โ ุฅุถุงูุฉ ูุฎุฒูู ุฌุฏูุฏ</button>
          </div>

          <div class="form-container" id="newInventoryFormContainer" style="display:none;">
            <div class="form card">
              <h3>ุฅุถุงูุฉ ูุฎุฒูู ุฌุฏูุฏ</h3>
              <div class="form-sections">
                <div class="form-section">
                  <h4>ูุนูููุงุช ุงููุฎุฒูู</h4>
                  <div class="form-grid">
                    <div class="form-group">
                      <label>ุงูููุชุฌ</label>
                      <input type="text" id="product-search" placeholder="ุงุจุฏุฃ ุจูุชุงุจุฉ ุงุณู ุงูููุชุฌ..." required />
                      <div id="product-suggestions" class="suggestions-container"></div>
                    </div>
                    <div class="form-group">
                      <label>ุงููุฎุฒู</label>
                      <select id="warehouse-select" required>
                        <option value="">ุงุฎุชุฑ ุงููุฎุฒู</option>
                        <option value="main">ุงููุฎุฒู ุงูุฑุฆูุณู</option>
                        <option value="secondary">ุงููุฎุฒู ุงูุซุงููู</option>
                        <option value="external">ุงููุฎุฒู ุงูุฎุงุฑุฌู</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label>ุงููููุฉ ุงููุถุงูุฉ</label>
                      <input type="number" required />
                    </div>
                    <div class="form-group">
                      <label>ุชุงุฑูุฎ ุงูุฅุถุงูุฉ</label>
                      <input type="date" required />
                    </div>
                    <div class="form-group">
                      <label>ุฑูู ุงูุฑู</label>
                      <input type="text" required />
                    </div>
                    <div class="form-group">
                      <label>ุงููููุน ูู ุงููุฎุฒู</label>
                      <input type="text" required />
                    </div>
                    <div class="form-group">
                      <label>ููุงุญุธุงุช</label>
                      <textarea></textarea>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn-green">ุญูุธ</button>
                <button type="button" class="btn-secondary" onclick="document.getElementById('newInventoryFormContainer').style.display = 'none'">ุฅูุบุงุก</button>
              </div>
            </div>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ุงูููุชุฌ</th>
                  <th>ุงููููุฉ ุงูุญุงููุฉ</th>
                  <th>ุงูุญุฏ ุงูุฃุฏูู</th>
                  <th>ุขุฎุฑ ุชุญุฏูุซ</th>
                  <th>ุงูุญุงูุฉ</th>
                  <th>ุงูุฅุฌุฑุงุกุงุช</th>
                </tr>
              </thead>
              <tbody id="inventory-table-body">
                <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
              </tbody>
            </table>
          </div>

          <div class="table-header">
            <br>
            <h3>ูุงุฆูุฉ ุงููุฎุงุฒู</h3>
            <button class="btn-green" onclick="document.getElementById('newWarehouseFormContainer').style.display = document.getElementById('newWarehouseFormContainer').style.display === 'none' ? 'block' : 'none'">โ ุฅุถุงูุฉ ูุฎุฒู ุฌุฏูุฏ</button>
          </div>

          <div class="form-container" id="newWarehouseFormContainer" style="display:none;">
            <div class="form card">
              <h3>ุฅุถุงูุฉ ูุฎุฒู ุฌุฏูุฏ</h3>
              <div class="form-sections">
                <div class="form-section">
                  <h4>ูุนูููุงุช ุงููุฎุฒู</h4>
                  <div class="form-grid">
                    <div class="form-group">
                      <label>ุงุณู ุงููุฎุฒู</label>
                      <input type="text" required />
                    </div>
                    <div class="form-group">
                      <label>ุงููููุน</label>
                      <input type="text" required />
                    </div>
                    <div class="form-group">
                      <label>ุงูุณุนุฉ</label>
                      <input type="number" required />
                    </div>
                    <div class="form-group">
                      <label>ุงููุณุคูู</label>
                      <input type="text" required />
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-actions">
                <button type="submit" class="btn-green">ุญูุธ</button>
                <button type="button" class="btn-secondary" onclick="document.getElementById('newWarehouseFormContainer').style.display = 'none'">ุฅูุบุงุก</button>
              </div>
            </div>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ุงุณู ุงููุฎุฒู</th>
                  <th>ุงููููุน</th>
                  <th>ุงูุณุนุฉ</th>
                  <th>ุงููุณุคูู</th>
                  <th>ุงูุญุงูุฉ</th>
                  <th>ุงูุฅุฌุฑุงุกุงุช</th>
                </tr>
              </thead>
              <tbody id="warehouses-table-body">
                <!-- ุณูุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- ุฅุถุงูุฉ ุณุชุงููุงุช CSS ุงููุทููุจุฉ -->
    <style>
      /* ุชูุณูู ุงูููุงุฐุฌ */
      .form-sections {
        display: grid;
        gap: 24px;
        margin-bottom: 24px;
      }

      .form-section {
        background: #f8fafc;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .form-section h4 {
        margin: 0 0 20px 0;
        color: #1e3a8a;
        font-size: 1.1rem;
        padding-bottom: 10px;
        border-bottom: 1px solid #e2e8f0;
      }

      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .form-group label {
        color: #1e293b;
        font-weight: 500;
        font-size: 0.9rem;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        padding: 10px 12px;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        font-size: 0.9rem;
        width: 100%;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
      }

      .form-actions {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #e2e8f0;
      }

      /* ุชูุณูู ูุฑุจุน ุงูุงูุชุฑุงุญุงุช */
      .suggestions-container {
        position: absolute;
        width: 100%;
        max-height: 200px;
        overflow-y: auto;
        background-color: #fff;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        z-index: 100;
        display: none;
        margin-top: 2px;
      }

      .suggestion-item {
        padding: 8px 12px;
        cursor: pointer;
        transition: background-color 0.2s ease;
        display: flex;
        flex-direction: column;
        gap: 4px;
        border-bottom: 1px solid #f1f5f9;
      }

      .suggestion-item:last-child {
        border-bottom: none;
      }

      .suggestion-item:hover, .suggestion-item.active {
        background-color: #f1f5f9;
      }

      .product-category, .product-sku {
        font-size: 0.8rem;
        color: #64748b;
        margin-right: 8px;
      }

      .product-sku {
        font-family: monospace;
        background-color: #f1f5f9;
        padding: 2px 4px;
        border-radius: 4px;
      }

      mark {
        background-color: rgba(34, 197, 94, 0.2);
        color: #166534;
        padding: 0 2px;
        border-radius: 2px;
        font-weight: 500;
      }

      input.selected {
        border-color: #22c55e;
        background-color: rgba(34, 197, 94, 0.05);
        transition: all 0.3s ease;
      }

      /* ุชูุณูู ูููุถุน ุงููููู */
      .dark .suggestions-container {
        background-color: #1e293b;
        border-color: #475569;
      }

      .dark .suggestion-item {
        border-bottom-color: #334155;
      }

      .dark .suggestion-item:hover, .dark .suggestion-item.active {
        background-color: #334155;
      }

      .dark .product-category, .dark .product-sku {
        color: #94a3b8;
      }

      .dark .product-sku {
        background-color: #334155;
      }

      .dark mark {
        background-color: rgba(34, 197, 94, 0.3);
        color: #4ade80;
      }

      .dark input.selected {
        border-color: #22c55e;
        background-color: rgba(34, 197, 94, 0.1);
      }

      .dark .form-section {
        background: var(--dark-chart);
      }

      .dark .form-section h4 {
        color: var(--dark-text);
        border-color: #334155;
      }

      .dark .form-group label {
        color: var(--dark-text);
      }

      .dark .form-group input,
      .dark .form-group select,
      .dark .form-group textarea {
        background: var(--dark-card);
        color: var(--dark-text);
        border-color: #334155;
      }

      .dark .form-actions {
        border-color: #334155;
      }

      .table-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        padding: 0 1rem;
      }

      .table-header h3 {
        margin: 0;
      }
    </style>

    <script>
      // ุฏุงูุฉ ุชุฃููุฏ ุงูุญุฐู
      function confirmDelete(itemId, itemType) {
        if(confirm(`ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ${itemType} ุฑูู ${itemId}ุ`)) {
          alert(`ุชู ุญุฐู ${itemType} ุฑูู ${itemId}`);
        }
      }

      // ุฏุงูุฉ ุชุนุฏูู ุงูุนูุตุฑ
      function editItem(itemId, itemType) {
        alert(`ุชุนุฏูู ${itemType} ุฑูู ${itemId}`);
      }

      // ุฏุงูุฉ ุนุฑุถ ุงูุชูุงุตูู
      function viewDetails(itemId, itemType) {
        alert(`ุนุฑุถ ุชูุงุตูู ${itemType} ุฑูู ${itemId}`);
      }

      // ุณูุชู ุชูููุฐูุง ุนูุฏ ุชุญููู ุงูุตูุญุฉ
      document.addEventListener('DOMContentLoaded', function() {
        // ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูููุฎุฒูู
        const inventoryItems = [
          { id: 1, name: 'ูููุต ุฑุฌุงูู', current: 45, min: 10, lastUpdate: '2024-04-25', status: 'normal' },
          { id: 2, name: 'ุจูุทููู ุฌููุฒ', current: 8, min: 15, lastUpdate: '2024-04-20', status: 'low' },
          { id: 3, name: 'ุญุฐุงุก ุฑูุงุถู', current: 12, min: 5, lastUpdate: '2024-04-22', status: 'normal' },
          { id: 4, name: 'ุณุงุนุฉ ูุฏ', current: 3, min: 5, lastUpdate: '2024-04-21', status: 'low' },
          { id: 5, name: 'ุญููุจุฉ ุธูุฑ', current: 18, min: 8, lastUpdate: '2024-04-24', status: 'normal' }
        ];

        // ุจูุงูุงุช ุชุฌุฑูุจูุฉ ูููุฎุงุฒู
        const warehouses = [
          { id: 1, name: 'ุงููุฎุฒู ุงูุฑุฆูุณู', location: 'ุงูุทุงุจู ุงูุฃุฑุถู', capacity: 1000, manager: 'ุฃุญูุฏ ูุญูุฏ', status: 'active' },
          { id: 2, name: 'ุงููุฎุฒู ุงูุซุงููู', location: 'ุงูุทุงุจู ุงูุฃูู', capacity: 500, manager: 'ูุญูุฏ ุนูู', status: 'active' },
          { id: 3, name: 'ูุฎุฒู ุฎุงุฑุฌู', location: 'ุงููุจูู ุงูููุญู', capacity: 800, manager: 'ุณุงูู ุฎุงูุฏ', status: 'inactive' }
        ];

        // ููุก ุฌุฏูู ุงููุฎุฒูู
        const inventoryTableBody = document.getElementById('inventory-table-body');
        inventoryItems.forEach(item => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${item.name}</td>
            <td>${item.current}</td>
            <td>${item.min}</td>
            <td>${item.lastUpdate}</td>
            <td><span class="status-badge ${item.status === 'low' ? 'warning' : 'success'}">${item.status === 'low' ? 'ููุฎูุถ' : 'ุนุงุฏู'}</span></td>
            <td>
              <button class="btn-icon" onclick="viewDetails(${item.id}, 'ุงูููุชุฌ')">๐๏ธ</button>
              <button class="btn-icon" onclick="editItem(${item.id}, 'ุงูููุชุฌ')">โ๏ธ</button>
              <button class="btn-icon" onclick="confirmDelete(${item.id}, 'ุงูููุชุฌ')">๐๏ธ</button>
            </td>
          `;
          inventoryTableBody.appendChild(row);
        });

        // ููุก ุฌุฏูู ุงููุฎุงุฒู
        const warehousesTableBody = document.getElementById('warehouses-table-body');
        warehouses.forEach(warehouse => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${warehouse.name}</td>
            <td>${warehouse.location}</td>
            <td>${warehouse.capacity}</td>
            <td>${warehouse.manager}</td>
            <td><span class="status-badge ${warehouse.status === 'active' ? 'success' : 'inactive'}">${warehouse.status === 'active' ? 'ูุดุท' : 'ุบูุฑ ูุดุท'}</span></td>
            <td>
              <button class="btn-icon" onclick="viewDetails(${warehouse.id}, 'ุงููุฎุฒู')">๐๏ธ</button>
              <button class="btn-icon" onclick="editItem(${warehouse.id}, 'ุงููุฎุฒู')">โ๏ธ</button>
              <button class="btn-icon" onclick="confirmDelete(${warehouse.id}, 'ุงููุฎุฒู')">๐๏ธ</button>
            </td>
          `;
          warehousesTableBody.appendChild(row);
        });

        // ููุก ุชูุจููุงุช ุงููุฎุฒูู
        const inventoryAlerts = document.getElementById('inventory-alerts');
        const lowItems = inventoryItems.filter(item => item.status === 'low');
        if (lowItems.length > 0) {
          lowItems.forEach(item => {
            const alert = document.createElement('div');
            alert.className = 'alert warning';
            alert.innerHTML = `<strong>ุชูุจูู!</strong> ูููุฉ ุงูููุชุฌ "${item.name}" ููุฎูุถุฉ (${item.current} ูู ุฃุตู ${item.min} ุงููุทููุจุฉ).`;
            inventoryAlerts.appendChild(alert);
          });
        } else {
          const alert = document.createElement('div');
          alert.className = 'alert success';
          alert.innerHTML = '<strong>ุฌูุฏ!</strong> ุฌููุน ุงูููุชุฌุงุช ุถูู ุงููููุงุช ุงููุทููุจุฉ.';
          inventoryAlerts.appendChild(alert);
        }
      });

      // ูููุฐุฌ ุงูุงูุชุฑุงุญุงุช ููููุชุฌุงุช
      const productSearchInput = document.getElementById('product-search');
      const productSuggestionsContainer = document.getElementById('product-suggestions');

      // ุงูููุชุฌุงุช ุงูุชุฌุฑูุจูุฉ ููุงูุชุฑุงุญ
      const sampleProducts = [
        { id: 1, name: 'ูููุต ุฑุฌุงูู', sku: 'SHT-001', category: 'ููุงุจุณ' },
        { id: 2, name: 'ุจูุทููู ุฌููุฒ', sku: 'PNT-002', category: 'ููุงุจุณ' },
        { id: 3, name: 'ุญุฐุงุก ุฑูุงุถู', sku: 'SHO-001', category: 'ุฃุญุฐูุฉ' },
        { id: 4, name: 'ุณุงุนุฉ ูุฏ', sku: 'WAT-003', category: 'ุงูุณุณูุงุฑุงุช' },
        { id: 5, name: 'ุญููุจุฉ ุธูุฑ', sku: 'BAG-005', category: 'ุญูุงุฆุจ' }
      ];

      // ูุณุชูุน ุงูุฃุญุฏุงุซ ููุจุญุซ ูุงูุงูุชุฑุงุญุงุช
      if (productSearchInput) {
        productSearchInput.addEventListener('input', function() {
          const query = this.value.trim().toLowerCase();
          
          if (query.length < 2) {
            productSuggestionsContainer.style.display = 'none';
            return;
          }
          
          const filteredProducts = sampleProducts.filter(product => 
            product.name.toLowerCase().includes(query) || 
            product.sku.toLowerCase().includes(query)
          );
          
          if (filteredProducts.length > 0) {
            productSuggestionsContainer.innerHTML = '';
            
            filteredProducts.forEach(product => {
              const suggestionItem = document.createElement('div');
              suggestionItem.className = 'suggestion-item';
              
              // ุชูููุฒ ุงููุต ุงููุทุงุจู
              let highlightedName = product.name;
              if (product.name.toLowerCase().includes(query)) {
                const regex = new RegExp(`(${query})`, 'ig');
                highlightedName = product.name.replace(regex, '<mark>$1</mark>');
              }
              
              suggestionItem.innerHTML = `
                <div>${highlightedName}</div>
                <div>
                  <span class="product-category">${product.category}</span>
                  <span class="product-sku">${product.sku}</span>
                </div>
              `;
              
              suggestionItem.addEventListener('click', function() {
                productSearchInput.value = product.name;
                productSearchInput.classList.add('selected');
                productSuggestionsContainer.style.display = 'none';
              });
              
              productSuggestionsContainer.appendChild(suggestionItem);
            });
            
            productSuggestionsContainer.style.display = 'block';
          } else {
            productSuggestionsContainer.style.display = 'none';
          }
        });
        
        // ุฅุฎูุงุก ุงูุงูุชุฑุงุญุงุช ุนูุฏ ุงูููุฑ ุฎุงุฑุฌูุง
        document.addEventListener('click', function(e) {
          if (!productSearchInput.contains(e.target) && !productSuggestionsContainer.contains(e.target)) {
            productSuggestionsContainer.style.display = 'none';
          }
        });
      }

      // ุฏุงูุฉ ููุชุญ ูููุฐุฌ ุฅุถุงูุฉ ูุฎุฒูู ุฌุฏูุฏ
      function openAddStockForm() {
        document.getElementById('newInventoryFormContainer').style.display = 'block';
      }
    </script>
    <script src="../views/js/stores/index.js"> </script>
</body>
</html>